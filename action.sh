#!/system/bin/sh
#
# ==============================================================================
# ğŸ¬ action.sh - æ¨¡å—æ“ä½œå…¥å£è„šæœ¬
# ==============================================================================
#
# æä¾›ä¸€é”®å¯åŠ¨/åœæ­¢ä»£ç†æ ¸å¿ƒä¸»ç¨‹åºåŠé˜²ç«å¢™è§„åˆ™çš„æ“ä½œæ¥å£ã€‚
# - ç»Ÿä¸€å…¥å£ï¼Œä¾¿äºå¤–éƒ¨è°ƒç”¨å’Œé›†æˆ
# - ç®€åŒ–ç”¨æˆ·æ“ä½œæµç¨‹
#
# ==============================================================================
set -e

MODDIR=$(dirname "$0")
# shellcheck source=common.sh
. "$MODDIR/common.sh"

ui_print_safe "â¤ï¸â¤ï¸â¤ï¸=== [action] ===â¤ï¸â¤ï¸â¤ï¸"
ui_print_safe "ğŸ¬ æ­£åœ¨åˆ‡æ¢æœåŠ¡çŠ¶æ€..."

if [ -x "$SERVICE" ]; then

  if [ -f "$FLAG" ]; then

    ui_print_safe "â›” æœåŠ¡å·²è¿è¡Œï¼Œæ­£åœ¨åœæ­¢..."

    sh "$SERVICE" stop >/dev/null 2>&1 || {
      ui_print_safe "âŒ æœåŠ¡åœæ­¢å¤±è´¥"
      exit 1
    }
  else
    ui_print_safe "ğŸš€ æœåŠ¡æœªè¿è¡Œï¼Œæ­£åœ¨å¯åŠ¨..."

    sh "$SERVICE" >/dev/null 2>&1 || {
      ui_print_safe "âŒ æœåŠ¡å¯åŠ¨å¤±è´¥"
      exit 1
    }
  fi
fi