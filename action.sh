#!/system/bin/sh
# =====================================================================
# ğŸ¬ action.sh - æ¨¡å—æ“ä½œå…¥å£è„šæœ¬
# ---------------------------------------------------------------------
# ä¸€é”®å¯åŠ¨/åœæ­¢ä»£ç†æ ¸å¿ƒä¸»ç¨‹åºåŠé˜²ç«å¢™è§„åˆ™
# =====================================================================

set -e
trap '[ $? -ne 0 ] && abort_safe "â›” è„šæœ¬æ‰§è¡Œå¤±è´¥: $?"' EXIT

MODDIR=$(dirname "$0")
. "$MODDIR/common.sh"

log_safe "â¤ï¸=== [action] ===â¤ï¸"
log_safe "ğŸ¬ æ­£åœ¨åˆ‡æ¢æœåŠ¡çŠ¶æ€..."

[ -x "$SERVICE" ] || abort_safe "âŒ æœåŠ¡ $(basename "$SERVICE") ä¸å¯æ‰§è¡Œ, æ“ä½œä¸­æ­¢"

if [ -f "$FLAG" ]; then
  log_safe "â›” æœåŠ¡å·²è¿è¡Œ, æ­£åœ¨åœæ­¢..."
  $SERVICE stop >/dev/null 2>&1 || abort_safe "âŒ æœåŠ¡ $(basename "$SERVICE") åœæ­¢å¤±è´¥"
else
  log_safe "ğŸš€ æœåŠ¡æœªè¿è¡Œ, æ­£åœ¨å¯åŠ¨..."
  $SERVICE >/dev/null 2>&1 || log_safe "âŒ æœåŠ¡ $(basename "$SERVICE") å¯åŠ¨å¤±è´¥"
fi